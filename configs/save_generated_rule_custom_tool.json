{
  "name": "save_generated_rule",
  "description": "Saves a generated automation rule to the document store and updates the conflict detection database. Call this tool after generating a valid rule JSON and only after user confirmation. Input must be the complete rule object as a JSON string.",
  "color": "linear-gradient(rgb(141,66,199), rgb(216,49,103))",
  "iconSrc": "",
  "schema": "[{\"id\":0,\"property\":\"rule\",\"description\":\"The complete automation rule in JSON format\",\"type\":\"string\",\"required\":false}]",
  "func": "/*\n * Saves generated automation rules to generated_rules.json\n * Input: $rule - JSON string of the automation rule\n * Returns: Confirmation message with rule ID\n */\n\nconst fs = require('fs').promises;\nconst path = require('path');\n\ntry {\n    // Parse the full SmartThings rule\n    const fullRule = JSON.parse($rule);\n    \n    // Path to generated_rules.json - adjust if needed\n    const filePath = path.join(process.cwd(), 'generated_rules.json');\n    \n    // Read existing rules or create empty structure\n    let data = { rules: [] };\n    try {\n        const fileContent = await fs.readFile(filePath, 'utf8');\n        data = JSON.parse(fileContent);\n    } catch (readError) {\n        console.log('Creating new generated_rules.json file');\n    }\n    \n    // Generate unique rule ID\n    const ruleId = `rule_${String(data.rules.length + 1).padStart(3, '0')}`;\n    \n    // Add metadata to the rule\n    fullRule.rule_id = ruleId;\n    fullRule.created_at = new Date().toISOString();\n    \n    // Add to rules array\n    data.rules.push(fullRule);\n    \n    // Save to file\n    await fs.writeFile(filePath, JSON.stringify(data, null, 2), 'utf8');\n    \n    // Return success message\n    return `Rule saved successfully! Rule ID: ${ruleId}. Total rules in database: ${data.rules.length}. Remember to re-upsert documents to Pinecone to update conflict detection.`;\n    \n} catch (error) {\n    console.error('Error saving rule:', error);\n    return `Error saving rule: ${error.message}. Please check the JSON format and try again.`;\n}",
  "workspaceId": "1852719c-a8ec-42fa-9343-69bc0e529d27"
}